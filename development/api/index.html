<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>HF-AS5047U Driver: HF-AS5047U Driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/jothepro/doxygen-awesome-css" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HF-AS5047U Driver
   &#160;<span id="projectnumber">0.1.0-dev</span>
   </div>
   <div id="projectbrief">HF-AS5047U C++ Driver</div>
  </td>
 </tr>
 </tbody>
</table>
<div id="theme-selection">
 <label for="theme-select">Theme:</label>
 <select id="theme-select">
  <option value="theme-default">Default</option>
  <option value="theme-round">Round</option>
  <option value="theme-robot">Robot</option>
 </select>
</div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">HF-AS5047U Driver </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <b>Portable C++20 driver for the AS5047U magnetic encoder from ams with SPI interface, CRC protection, DAEC, and DFS‚Ñ¢</b></p>
<p><a href="https://en.cppreference.com/w/cpp/20"><img src="https://img.shields.io/badge/C%2B%2B-20-blue.svg" alt="C++" style="pointer-events: none;" class="inline"/></a> <a href="https://www.gnu.org/licenses/gpl-3.0"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/N3b3x/hf-as5047u-driver/actions/workflows/esp32-examples-build-ci.yml"><img src="https://github.com/N3b3x/hf-as5047u-driver/actions/workflows/esp32-examples-build-ci.yml/badge.svg?branch=main" alt="CI" style="pointer-events: none;" class="inline"/></a> <a href="https://n3b3x.github.io/hf-as5047u-driver/"><img src="https://img.shields.io/badge/docs-GitHub%20Pages-blue" alt="Docs" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
üìö Table of Contents</h1>
<ol type="1">
<li>Overview</li>
<li>Features</li>
<li>Quick Start</li>
<li>Installation</li>
<li>API Reference</li>
<li>Examples</li>
<li>Documentation</li>
<li>Contributing</li>
<li>License</li>
</ol>
<h1><a class="anchor" id="autotoc_md2"></a>
üì¶ Overview</h1>
<blockquote class="doxtable">
<p>&zwj;<b>üìñ <a href="https://n3b3x.github.io/hf-as5047u-driver/">üìöüåê Live Complete Documentation</a></b> - Interactive guides, examples, and step-by-step tutorials </p>
</blockquote>
<p><b>HF-AS5047U</b> is a portable C++20 driver for the <b>AS5047U</b> magnetic encoder from ams. It delivers fast 14‚Äëbit absolute angle readings over SPI, optional CRC protection and advanced features like Dynamic Angle Error Compensation (DAEC) and an adaptive Dynamic Filter System (DFS‚Ñ¢). The sensor can also output incremental (A/B/I) and 3‚Äëphase commutation (UVW) signals or a PWM encoded angle, making it a drop‚Äëin replacement for optical encoders in high-performance motor control and robotics.</p>
<p>The driver uses a CRTP-based <code>SpiInterface</code> for hardware abstraction, allowing it to run on any platform (ESP32, STM32, Arduino, etc.) with zero runtime overhead. It implements all major features from the AS5047U datasheet including absolute angle readout with/without DAEC, velocity measurement, AGC and magnetic field diagnostics, ABI/UVW/PWM interface configuration, error/status flag handling, and full OTP programming sequence.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
‚ú® Features</h1>
<ul>
<li>‚úÖ <b>14-bit absolute angle</b> with optional CRC check</li>
<li>‚úÖ <b>DAEC</b> (Dynamic Angle Error Compensation) for low-latency angle correction</li>
<li>‚úÖ <b>DFS‚Ñ¢</b> (Dynamic Filter System) adaptive noise filtering</li>
<li>‚úÖ <b>Stray-field immunity</b> for robust operation</li>
<li>‚úÖ <b>Incremental ABI outputs</b> up to 4096 PPR</li>
<li>‚úÖ <b>UVW commutation</b> with programmable pole pairs</li>
<li>‚úÖ <b>PWM output</b> option</li>
<li>‚úÖ <b>Diagnostics</b> for AGC, magnitude and error flags</li>
<li>‚úÖ <b>OTP memory</b> for permanent configuration</li>
<li>‚úÖ <b>Hardware Agnostic</b>: SPI interface for platform independence</li>
<li>‚úÖ <b>Modern C++</b>: C++20 with CRTP-based design</li>
<li>‚úÖ <b>Zero Overhead</b>: CRTP-based design for compile-time polymorphism</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
üöÄ Quick Start</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="as5047u_8hpp.html">as5047u.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 1. Implement the SPI interface (see platform_integration.md)</span></div>
<div class="line"><span class="keyword">class </span>MySpi : <span class="keyword">public</span> <a class="code hl_class" href="classas5047u_1_1SpiInterface.html">as5047u::SpiInterface</a>&lt;MySpi&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classas5047u_1_1SpiInterface.html#aafdd971e247401dd58852d6d0d65c979">transfer</a>(<span class="keyword">const</span> uint8_t* tx, uint8_t* rx, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">        <span class="comment">// Your SPI transfer implementation</span></div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 2. Create driver instance</span></div>
<div class="line">MySpi spi;</div>
<div class="line"><a class="code hl_class" href="classas5047u_1_1AS5047U.html">as5047u::AS5047U</a> encoder(spi, <a class="code hl_enumvalue" href="as5047u__types_8hpp.html#a6cd9dec52b39c355890e33ce6085c532a9ce40eb1f75bb2bfd670929f872624f5">FrameFormat::SPI_24</a>); <span class="comment">// 24-bit frames with CRC</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 3. Read angle</span></div>
<div class="line">uint16_t angle = encoder.GetAngle();             <span class="comment">// compensated angle</span></div>
<div class="line">uint16_t rawAngle = encoder.GetRawAngle();       <span class="comment">// raw angle without DAEC</span></div>
<div class="line">int16_t vel = encoder.GetVelocity();             <span class="comment">// velocity in sensor units</span></div>
<div class="line"><span class="keywordtype">float</span> vel_dps = encoder.GetVelocityDegPerSec(); <span class="comment">// velocity in deg/s</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 4. Diagnostics</span></div>
<div class="line">uint8_t agc = encoder.GetAGC();            <span class="comment">// automatic gain control</span></div>
<div class="line">uint16_t mag = encoder.GetMagnitude();     <span class="comment">// magnetic magnitude</span></div>
<div class="line">uint16_t errors = encoder.GetErrorFlags(); <span class="comment">// current error flags</span></div>
<div class="ttc" id="aas5047u_8hpp_html"><div class="ttname"><a href="as5047u_8hpp.html">as5047u.hpp</a></div><div class="ttdoc">Driver for AMS AS5047U Magnetic Rotary Position Sensor (C++21).</div></div>
<div class="ttc" id="aas5047u__types_8hpp_html_a6cd9dec52b39c355890e33ce6085c532a9ce40eb1f75bb2bfd670929f872624f5"><div class="ttname"><a href="as5047u__types_8hpp.html#a6cd9dec52b39c355890e33ce6085c532a9ce40eb1f75bb2bfd670929f872624f5">FrameFormat::SPI_24</a></div><div class="ttdeci">@ SPI_24</div></div>
<div class="ttc" id="aclassas5047u_1_1AS5047U_html"><div class="ttname"><a href="classas5047u_1_1AS5047U.html">as5047u::AS5047U</a></div><div class="ttdoc">AS5047U magnetic rotary sensor driver class.</div><div class="ttdef"><b>Definition</b> as5047u.hpp:79</div></div>
<div class="ttc" id="aclassas5047u_1_1SpiInterface_html"><div class="ttname"><a href="classas5047u_1_1SpiInterface.html">as5047u::SpiInterface</a></div><div class="ttdoc">CRTP-based template interface for SPI bus operations.</div><div class="ttdef"><b>Definition</b> as5047u_spi_interface.hpp:39</div></div>
<div class="ttc" id="aclassas5047u_1_1SpiInterface_html_aafdd971e247401dd58852d6d0d65c979"><div class="ttname"><a href="classas5047u_1_1SpiInterface.html#aafdd971e247401dd58852d6d0d65c979">as5047u::SpiInterface::transfer</a></div><div class="ttdeci">void transfer(const uint8_t *tx, uint8_t *rx, std::size_t len)</div><div class="ttdoc">Perform a full-duplex SPI data transfer.</div><div class="ttdef"><b>Definition</b> as5047u_spi_interface.hpp:54</div></div>
</div><!-- fragment --><p>For detailed setup, see Installation and Quick Start Guide.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
üîß Installation</h1>
<ol type="1">
<li><b>Clone or copy</b> the driver files into your project</li>
<li><b>Implement the SPI interface</b> for your platform (see Platform Integration)</li>
<li><b>Include the header</b> in your code: <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="as5047u_8hpp.html">as5047u.hpp</a>&quot;</span></div>
</div><!-- fragment --></li>
<li>Compile with a <b>C++20</b> or newer compiler</li>
</ol>
<p>For detailed installation instructions, see docs/installation.md.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
üìñ API Reference</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>GetAngle()</code>   </td><td class="markdownTableBodyNone">Read 14-bit compensated absolute angle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GetRawAngle()</code>   </td><td class="markdownTableBodyNone">Read 14-bit raw absolute angle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>GetVelocity()</code>   </td><td class="markdownTableBodyNone">Read signed 14-bit velocity (LSB units)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GetVelocityDegPerSec()</code>   </td><td class="markdownTableBodyNone">Velocity in degrees/sec    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>GetVelocityRPM()</code>   </td><td class="markdownTableBodyNone">Velocity in revolutions per minute    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GetAGC()</code>   </td><td class="markdownTableBodyNone">Read AGC (0‚Äì255) value    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>GetMagnitude()</code>   </td><td class="markdownTableBodyNone">Read magnetic field magnitude    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>GetErrorFlags()</code>   </td><td class="markdownTableBodyNone">Read and clear error/status flags    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SetZeroPosition()</code>   </td><td class="markdownTableBodyNone">Set new zero offset    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SetDirection()</code>   </td><td class="markdownTableBodyNone">Set rotation direction (CW or CCW)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SetABIResolution()</code>   </td><td class="markdownTableBodyNone">Set ABI output resolution (10‚Äì14 bits)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SetUVWPolePairs()</code>   </td><td class="markdownTableBodyNone">Set UVW pole pairs (1‚Äì7)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ConfigureInterface()</code>   </td><td class="markdownTableBodyNone">Enable/disable ABI, UVW, PWM    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SetDynamicAngleCompensation()</code>   </td><td class="markdownTableBodyNone">Enable/disable DAEC    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SetAdaptiveFilter()</code>   </td><td class="markdownTableBodyNone">Enable/disable adaptive filter (DFS)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ProgramOTP()</code>   </td><td class="markdownTableBodyNone">Program current settings into OTP   </td></tr>
</table>
<p>For complete API documentation, see docs/api_reference.md.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
üìä Examples</h1>
<p>For ESP32 examples, see the <a href="examples/esp32/">examples/esp32</a> directory. Additional examples for other platforms are available in the <a href="examples/">examples</a> directory.</p>
<p>Detailed example walkthroughs are available in docs/examples.md.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
üìö Documentation</h1>
<p>For complete documentation, see the docs directory.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
ü§ù Contributing</h1>
<p>Pull requests and suggestions are welcome! Please follow the existing code style and include tests for new features.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
üìÑ License</h1>
<p>This project is licensed under the <b>GNU General Public License v3.0</b>. See the [LICENSE](LICENSE) file for details. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
